<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1" /> 
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	
	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<script src="cordova.js"></script>
	
	<script src="js/jquery-2.0.0.js"></script>
	<script src="js/push.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	
	<script type="text/javascript" charset="utf-8">
		// Wait for device API libraries to load
		//
		function onLoad() {
			document.addEventListener("deviceready", onDeviceReady, false);
		}

		// device APIs are available
		
		function onDeviceReady() {
			// Now safe to use device APIs
			document.addEventListener("backbutton", onBackKeyDown, false);
			var os = device.platform;
			if(os == "Android") $(".quit").removeClass('hidden');
		}


		function openURL(urlString){
			myURL = encodeURI(urlString);
			window.open(myURL, '_self');
		}
		
		function exitFromApp()
		{

			navigator.app.exitApp();
		}


		document.addEventListener("backbutton", function(e){
			if($.mobile.activePage.is('#homepage')){
				
				navigator.app.exitApp();
			}
			else {
				navigator.app.backHistory()
			}
		}, false);

		
	</script>

	<style>

		.col-xs-6{padding: 0px; margin-bottom: 10px}
		a:active, a:focus, a:hover{color: white !important; text-decoration: none}
	</style>
</head>
<body onload="onLoad()" style="  background-image:url(background.jpg); background-repeat: no-repeat; background-cover: cover;">

	<div class="page" style="padding:0px">

		<div style="  text-align:center;  padding:20px; padding-top: 50px "><img style="width:150px" src="logo.png" /></div>


		<div class="row" style="margin: 0px auto; width:100%; padding-top:100px">
			<div class="col-xs-12"><a href="order.html" class="button"  ><i class="fa fa-cutlery fa-2x"></i><br/>ORDER NOW</a></div>

			
			<div class="col-xs-12"><a href="#" class="button"  onclick="exitFromApp()"><i class="fa fa-sign-out fa-2x"></i><br/>EXIT</a></div>
			
		</div>

		
	</div>

	<script>


		function onDeviceReady(){
			console.log("Device Ready");

			var push = PushNotification.init({
				android: {
					senderID: "974167092163",
					icon: 'icons',
					sound: true,
					vibrate: true,
					alert: true,
					forceShow: true,
					topics: ['test1']
				},
				browser: {
					pushServiceURL: 'http://push.api.phonegap.com/v1/push'
				},
				ios: {
					alert: true,
					badge: true,
					sound: true
				},
				windows: {}
			});

			push.on('registration', function(data) {
				console.log(data.registrationId);

				$("#gcm_id").html(data.registrationId);


				var user = data.registrationId;


			});

			push.on('notification', function(data) {

				console.log(data.message);

				var d = new Date();

				var month = d.getMonth()+1;
				var day = d.getDate();

				var today = d.getFullYear() + '/' +(month<10 ? '0' : '') + month + '/' +(day<10 ? '0' : '') + day;

				var storage = window.localStorage;
				var notifs = data.title+'//'+data.message+'//'+today;


				var current_notifs = storage.getItem('notifs');
				
				if(current_notifs != null)
				{
					var notifs_array = JSON.parse(current_notifs); 
				}
				else
				{
					var notifs_array = [];
				}

				notifs_array.unshift(notifs);
				storage.setItem('notifs', JSON.stringify( notifs_array ));



				alert(data.message);



//alert(data.title+" Message: " +data.message);
// data.title,
// data.count,
// data.sound,
// data.image,
// data.additionalData
});

			push.on('error', function(e) {
				alert(e.message);
			});
		}


		document.addEventListener("deviceready",onDeviceReady,false);


		onDeviceReady();



	</script>

</body>
</html>
